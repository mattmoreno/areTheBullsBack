/**
 * vat validator
 *
 * @link        http://formvalidation.io/validators/vat/
 * @author      https://twitter.com/nghuuphuoc
 * @copyright   (c) 2013 - 2015 Nguyen Huu Phuoc
 * @license     http://formvalidation.io/license/
 */
!function($){FormValidation.I18n=$.extend(!0,FormValidation.I18n||{},{en_US:{vat:{"default":"Please enter a valid VAT number",country:"Please enter a valid VAT number in %s",countries:{AT:"Austria",BE:"Belgium",BG:"Bulgaria",BR:"Brazil",CH:"Switzerland",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DK:"Denmark",EE:"Estonia",ES:"Spain",FI:"Finland",FR:"France",GB:"United Kingdom",GR:"Greek",EL:"Greek",HU:"Hungary",HR:"Croatia",IE:"Ireland",IS:"Iceland",IT:"Italy",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",MT:"Malta",NL:"Netherlands",NO:"Norway",PL:"Poland",PT:"Portugal",RO:"Romania",RU:"Russia",RS:"Serbia",SE:"Sweden",SI:"Slovenia",SK:"Slovakia",VE:"Venezuela",ZA:"South Africa"}}}}),FormValidation.Validator.vat={html5Attributes:{message:"message",country:"country"},COUNTRY_CODES:["AT","BE","BG","BR","CH","CY","CZ","DE","DK","EE","EL","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LT","LU","LV","MT","NL","NO","PL","PT","RO","RU","RS","SE","SK","SI","VE","ZA"],validate:function(t,r,s){var e=t.getFieldValue(r,"vat");if(""===e)return!0;var n=t.getLocale(),u=s.country;if(u?("string"!=typeof u||-1===$.inArray(u.toUpperCase(),this.COUNTRY_CODES))&&(u=t.getDynamicOption(r,u)):u=e.substr(0,2),-1===$.inArray(u,this.COUNTRY_CODES))return!0;var a=["_",u.toLowerCase()].join("");return this[a](e)?!0:{valid:!1,message:FormValidation.Helper.format(s.message||FormValidation.I18n[n].vat.country,FormValidation.I18n[n].vat.countries[u.toUpperCase()])}},_at:function(t){if(/^ATU[0-9]{8}$/.test(t)&&(t=t.substr(2)),!/^U[0-9]{8}$/.test(t))return!1;t=t.substr(1);for(var r=0,s=[1,2,1,2,1,2,1],e=0,n=0;7>n;n++)e=parseInt(t.charAt(n),10)*s[n],e>9&&(e=Math.floor(e/10)+e%10),r+=e;return r=10-(r+4)%10,10===r&&(r=0),r+""===t.substr(7,1)},_be:function(t){if(/^BE[0]{0,1}[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0]{0,1}[0-9]{9}$/.test(t))return!1;if(9===t.length&&(t="0"+t),"0"===t.substr(1,1))return!1;var r=parseInt(t.substr(0,8),10)+parseInt(t.substr(8,2),10);return r%97===0},_bg:function(t){if(/^BG[0-9]{9,10}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9,10}$/.test(t))return!1;var r=0,s=0;if(9===t.length){for(s=0;8>s;s++)r+=parseInt(t.charAt(s),10)*(s+1);if(r%=11,10===r)for(r=0,s=0;8>s;s++)r+=parseInt(t.charAt(s),10)*(s+3);return r%=10,r+""===t.substr(8)}if(10===t.length){var e=function(t){var r=parseInt(t.substr(0,2),10)+1900,s=parseInt(t.substr(2,2),10),e=parseInt(t.substr(4,2),10);if(s>40?(r+=100,s-=40):s>20&&(r-=100,s-=20),!FormValidation.Helper.date(r,s,e))return!1;for(var n=0,u=[2,4,8,5,10,9,7,3,6],a=0;9>a;a++)n+=parseInt(t.charAt(a),10)*u[a];return n=n%11%10,n+""===t.substr(9,1)},n=function(t){for(var r=0,s=[21,19,17,13,11,9,7,3,1],e=0;9>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%=10,r+""===t.substr(9,1)},u=function(t){for(var r=0,s=[4,3,2,7,6,5,4,3,2],e=0;9>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r=11-r%11,10===r?!1:(11===r&&(r=0),r+""===t.substr(9,1))};return e(t)||n(t)||u(t)}return!1},_br:function(t){if(""===t)return!0;var r=t.replace(/[^\d]+/g,"");if(""===r||14!==r.length)return!1;if("00000000000000"===r||"11111111111111"===r||"22222222222222"===r||"33333333333333"===r||"44444444444444"===r||"55555555555555"===r||"66666666666666"===r||"77777777777777"===r||"88888888888888"===r||"99999999999999"===r)return!1;for(var s=r.length-2,e=r.substring(0,s),n=r.substring(s),u=0,a=s-7,i=s;i>=1;i--)u+=parseInt(e.charAt(s-i),10)*a--,2>a&&(a=9);var f=2>u%11?0:11-u%11;if(f!==parseInt(n.charAt(0),10))return!1;for(s+=1,e=r.substring(0,s),u=0,a=s-7,i=s;i>=1;i--)u+=parseInt(e.charAt(s-i),10)*a--,2>a&&(a=9);return f=2>u%11?0:11-u%11,f===parseInt(n.charAt(1),10)},_ch:function(t){if(/^CHE[0-9]{9}(MWST)?$/.test(t)&&(t=t.substr(2)),!/^E[0-9]{9}(MWST)?$/.test(t))return!1;t=t.substr(1);for(var r=0,s=[5,4,3,2,7,6,5,4],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r=11-r%11,10===r?!1:(11===r&&(r=0),r+""===t.substr(8,1))},_cy:function(t){if(/^CY[0-5|9]{1}[0-9]{7}[A-Z]{1}$/.test(t)&&(t=t.substr(2)),!/^[0-5|9]{1}[0-9]{7}[A-Z]{1}$/.test(t))return!1;if("12"===t.substr(0,2))return!1;for(var r=0,s={0:1,1:0,2:5,3:7,4:9,5:13,6:15,7:17,8:19,9:21},e=0;8>e;e++){var n=parseInt(t.charAt(e),10);e%2===0&&(n=s[n+""]),r+=n}return r="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[r%26],r+""===t.substr(8,1)},_cz:function(t){if(/^CZ[0-9]{8,10}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{8,10}$/.test(t))return!1;var r=0,s=0;if(8===t.length){if(t.charAt(0)+""=="9")return!1;for(r=0,s=0;7>s;s++)r+=parseInt(t.charAt(s),10)*(8-s);return r=11-r%11,10===r&&(r=0),11===r&&(r=1),r+""===t.substr(7,1)}if(9===t.length&&t.charAt(0)+""=="6"){for(r=0,s=0;7>s;s++)r+=parseInt(t.charAt(s+1),10)*(8-s);return r=11-r%11,10===r&&(r=0),11===r&&(r=1),r=[8,7,6,5,4,3,2,1,0,9,10][r-1],r+""===t.substr(8,1)}if(9===t.length||10===t.length){var e=1900+parseInt(t.substr(0,2),10),n=parseInt(t.substr(2,2),10)%50%20,u=parseInt(t.substr(4,2),10);if(9===t.length){if(e>=1980&&(e-=100),e>1953)return!1}else 1954>e&&(e+=100);if(!FormValidation.Helper.date(e,n,u))return!1;if(10===t.length){var a=parseInt(t.substr(0,9),10)%11;return 1985>e&&(a%=10),a+""===t.substr(9,1)}return!0}return!1},_de:function(t){return/^DE[0-9]{9}$/.test(t)&&(t=t.substr(2)),/^[0-9]{9}$/.test(t)?FormValidation.Helper.mod11And10(t):!1},_dk:function(t){if(/^DK[0-9]{8}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{8}$/.test(t))return!1;for(var r=0,s=[2,7,6,5,4,3,2,1],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%11===0},_ee:function(t){if(/^EE[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9}$/.test(t))return!1;for(var r=0,s=[3,7,1,3,7,1,3,7,1],e=0;9>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%10===0},_es:function(t){if(/^ES[0-9A-Z][0-9]{7}[0-9A-Z]$/.test(t)&&(t=t.substr(2)),!/^[0-9A-Z][0-9]{7}[0-9A-Z]$/.test(t))return!1;var r=function(t){var r=parseInt(t.substr(0,8),10);return r="TRWAGMYFPDXBNJZSQVHLCKE"[r%23],r+""===t.substr(8,1)},s=function(t){var r=["XYZ".indexOf(t.charAt(0)),t.substr(1)].join("");return r=parseInt(r,10),r="TRWAGMYFPDXBNJZSQVHLCKE"[r%23],r+""===t.substr(8,1)},e=function(t){var r=t.charAt(0),s;if(-1!=="KLM".indexOf(r))return s=parseInt(t.substr(1,8),10),s="TRWAGMYFPDXBNJZSQVHLCKE"[s%23],s+""===t.substr(8,1);if(-1!=="ABCDEFGHJNPQRSUVW".indexOf(r)){for(var e=0,n=[2,1,2,1,2,1,2],u=0,a=0;7>a;a++)u=parseInt(t.charAt(a+1),10)*n[a],u>9&&(u=Math.floor(u/10)+u%10),e+=u;return e=10-e%10,10===e&&(e=0),e+""===t.substr(8,1)||"JABCDEFGHI"[e]===t.substr(8,1)}return!1},n=t.charAt(0);return/^[0-9]$/.test(n)?r(t):/^[XYZ]$/.test(n)?s(t):e(t)},_fi:function(t){if(/^FI[0-9]{8}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{8}$/.test(t))return!1;for(var r=0,s=[7,9,10,5,8,4,2,1],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%11===0},_fr:function(t){if(/^FR[0-9A-Z]{2}[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0-9A-Z]{2}[0-9]{9}$/.test(t))return!1;if(!FormValidation.Helper.luhn(t.substr(2)))return!1;if(/^[0-9]{2}$/.test(t.substr(0,2)))return t.substr(0,2)===parseInt(t.substr(2)+"12",10)%97+"";var r="0123456789ABCDEFGHJKLMNPQRSTUVWXYZ",s;return s=/^[0-9]{1}$/.test(t.charAt(0))?24*r.indexOf(t.charAt(0))+r.indexOf(t.charAt(1))-10:34*r.indexOf(t.charAt(0))+r.indexOf(t.charAt(1))-100,(parseInt(t.substr(2),10)+1+Math.floor(s/11))%11===s%11},_gb:function(t){if((/^GB[0-9]{9}$/.test(t)||/^GB[0-9]{12}$/.test(t)||/^GBGD[0-9]{3}$/.test(t)||/^GBHA[0-9]{3}$/.test(t)||/^GB(GD|HA)8888[0-9]{5}$/.test(t))&&(t=t.substr(2)),!(/^[0-9]{9}$/.test(t)||/^[0-9]{12}$/.test(t)||/^GD[0-9]{3}$/.test(t)||/^HA[0-9]{3}$/.test(t)||/^(GD|HA)8888[0-9]{5}$/.test(t)))return!1;var r=t.length;if(5===r){var s=t.substr(0,2),e=parseInt(t.substr(2),10);return"GD"===s&&500>e||"HA"===s&&e>=500}if(11===r&&("GD8888"===t.substr(0,6)||"HA8888"===t.substr(0,6)))return"GD"===t.substr(0,2)&&parseInt(t.substr(6,3),10)>=500||"HA"===t.substr(0,2)&&parseInt(t.substr(6,3),10)<500?!1:parseInt(t.substr(6,3),10)%97===parseInt(t.substr(9,2),10);if(9===r||12===r){for(var n=0,u=[8,7,6,5,4,3,2,10,1],a=0;9>a;a++)n+=parseInt(t.charAt(a),10)*u[a];return n%=97,parseInt(t.substr(0,3),10)>=100?0===n||42===n||55===n:0===n}return!0},_gr:function(t){if(/^(GR|EL)[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9}$/.test(t))return!1;8===t.length&&(t="0"+t);for(var r=0,s=[256,128,64,32,16,8,4,2],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r=r%11%10,r+""===t.substr(8,1)},_el:function(t){return this._gr(t)},_hu:function(t){if(/^HU[0-9]{8}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{8}$/.test(t))return!1;for(var r=0,s=[9,7,3,1,9,7,3,1],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%10===0},_hr:function(t){return/^HR[0-9]{11}$/.test(t)&&(t=t.substr(2)),/^[0-9]{11}$/.test(t)?FormValidation.Helper.mod11And10(t):!1},_ie:function(t){if(/^IE[0-9]{1}[0-9A-Z\*\+]{1}[0-9]{5}[A-Z]{1,2}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{1}[0-9A-Z\*\+]{1}[0-9]{5}[A-Z]{1,2}$/.test(t))return!1;var r=function(t){for(;t.length<7;)t="0"+t;for(var r="WABCDEFGHIJKLMNOPQRSTUV",s=0,e=0;7>e;e++)s+=parseInt(t.charAt(e),10)*(8-e);return s+=9*r.indexOf(t.substr(7)),r[s%23]};return/^[0-9]+$/.test(t.substr(0,7))?t.charAt(7)===r(t.substr(0,7)+t.substr(8)+""):-1!=="ABCDEFGHIJKLMNOPQRSTUVWXYZ+*".indexOf(t.charAt(1))?t.charAt(7)===r(t.substr(2,5)+t.substr(0,1)+""):!0},_is:function(t){return/^IS[0-9]{5,6}$/.test(t)&&(t=t.substr(2)),/^[0-9]{5,6}$/.test(t)},_it:function(t){if(/^IT[0-9]{11}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{11}$/.test(t))return!1;if(0===parseInt(t.substr(0,7),10))return!1;var r=parseInt(t.substr(7,3),10);return 1>r||r>201&&999!==r&&888!==r?!1:FormValidation.Helper.luhn(t)},_lt:function(t){if(/^LT([0-9]{7}1[0-9]{1}|[0-9]{10}1[0-9]{1})$/.test(t)&&(t=t.substr(2)),!/^([0-9]{7}1[0-9]{1}|[0-9]{10}1[0-9]{1})$/.test(t))return!1;var r=t.length,s=0,e;for(e=0;r-1>e;e++)s+=parseInt(t.charAt(e),10)*(1+e%9);var n=s%11;if(10===n)for(s=0,e=0;r-1>e;e++)s+=parseInt(t.charAt(e),10)*(1+(e+2)%9);return n=n%11%10,n+""===t.charAt(r-1)},_lu:function(t){return/^LU[0-9]{8}$/.test(t)&&(t=t.substr(2)),/^[0-9]{8}$/.test(t)?parseInt(t.substr(0,6),10)%89+""===t.substr(6,2):!1},_lv:function(t){if(/^LV[0-9]{11}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{11}$/.test(t))return!1;var r=parseInt(t.charAt(0),10),s=0,e=[],n,u=t.length;if(r>3){for(s=0,e=[9,1,4,8,3,10,2,5,7,6,1],n=0;u>n;n++)s+=parseInt(t.charAt(n),10)*e[n];return s%=11,3===s}var a=parseInt(t.substr(0,2),10),i=parseInt(t.substr(2,2),10),f=parseInt(t.substr(4,2),10);if(f=f+1800+100*parseInt(t.charAt(6),10),!FormValidation.Helper.date(f,i,a))return!1;for(s=0,e=[10,5,8,4,2,1,6,3,7,9],n=0;u-1>n;n++)s+=parseInt(t.charAt(n),10)*e[n];return s=(s+1)%11%10,s+""===t.charAt(u-1)},_mt:function(t){if(/^MT[0-9]{8}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{8}$/.test(t))return!1;for(var r=0,s=[3,4,6,7,8,9,10,1],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%37===0},_nl:function(t){if(/^NL[0-9]{9}B[0-9]{2}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9}B[0-9]{2}$/.test(t))return!1;for(var r=0,s=[9,8,7,6,5,4,3,2],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%=11,r>9&&(r=0),r+""===t.substr(8,1)},_no:function(t){if(/^NO[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9}$/.test(t))return!1;for(var r=0,s=[3,2,7,6,5,4,3,2],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r=11-r%11,11===r&&(r=0),r+""===t.substr(8,1)},_pl:function(t){if(/^PL[0-9]{10}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{10}$/.test(t))return!1;for(var r=0,s=[6,5,7,2,3,4,5,6,7,-1],e=0;10>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r%11===0},_pt:function(t){if(/^PT[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9}$/.test(t))return!1;for(var r=0,s=[9,8,7,6,5,4,3,2],e=0;8>e;e++)r+=parseInt(t.charAt(e),10)*s[e];return r=11-r%11,r>9&&(r=0),r+""===t.substr(8,1)},_ro:function(t){if(/^RO[1-9][0-9]{1,9}$/.test(t)&&(t=t.substr(2)),!/^[1-9][0-9]{1,9}$/.test(t))return!1;for(var r=t.length,s=[7,5,3,2,1,7,5,3,2].slice(10-r),e=0,n=0;r-1>n;n++)e+=parseInt(t.charAt(n),10)*s[n];return e=10*e%11%10,e+""===t.substr(r-1,1)},_ru:function(t){if(/^RU([0-9]{10}|[0-9]{12})$/.test(t)&&(t=t.substr(2)),!/^([0-9]{10}|[0-9]{12})$/.test(t))return!1;var r=0;if(10===t.length){var s=0,e=[2,4,10,3,5,9,4,6,8,0];for(r=0;10>r;r++)s+=parseInt(t.charAt(r),10)*e[r];return s%=11,s>9&&(s%=10),s+""===t.substr(9,1)}if(12===t.length){var n=0,u=[7,2,4,10,3,5,9,4,6,8,0],a=0,i=[3,7,2,4,10,3,5,9,4,6,8,0];for(r=0;11>r;r++)n+=parseInt(t.charAt(r),10)*u[r],a+=parseInt(t.charAt(r),10)*i[r];return n%=11,n>9&&(n%=10),a%=11,a>9&&(a%=10),n+""===t.substr(10,1)&&a+""===t.substr(11,1)}return!1},_rs:function(t){if(/^RS[0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[0-9]{9}$/.test(t))return!1;for(var r=10,s=0,e=0;8>e;e++)s=(parseInt(t.charAt(e),10)+r)%10,0===s&&(s=10),r=2*s%11;return(r+parseInt(t.substr(8,1),10))%10===1},_se:function(t){return/^SE[0-9]{10}01$/.test(t)&&(t=t.substr(2)),/^[0-9]{10}01$/.test(t)?(t=t.substr(0,10),FormValidation.Helper.luhn(t)):!1},_si:function(t){var r=t.match(/^(SI)?([1-9][0-9]{7})$/);if(!r)return!1;r[1]&&(t=t.substr(2));for(var s=0,e=[8,7,6,5,4,3,2],n=0;7>n;n++)s+=parseInt(t.charAt(n),10)*e[n];return s=11-s%11,10===s&&(s=0),s+""===t.substr(7,1)},_sk:function(t){return/^SK[1-9][0-9][(2-4)|(6-9)][0-9]{7}$/.test(t)&&(t=t.substr(2)),/^[1-9][0-9][(2-4)|(6-9)][0-9]{7}$/.test(t)?parseInt(t,10)%11===0:!1},_ve:function(t){if(/^VE[VEJPG][0-9]{9}$/.test(t)&&(t=t.substr(2)),!/^[VEJPG][0-9]{9}$/.test(t))return!1;for(var r={V:4,E:8,J:12,P:16,G:20},s=r[t.charAt(0)],e=[3,2,7,6,5,4,3,2],n=0;8>n;n++)s+=parseInt(t.charAt(n+1),10)*e[n];return s=11-s%11,(11===s||10===s)&&(s=0),s+""===t.substr(9,1)},_za:function(t){return/^ZA4[0-9]{9}$/.test(t)&&(t=t.substr(2)),/^4[0-9]{9}$/.test(t)}}}(jQuery);